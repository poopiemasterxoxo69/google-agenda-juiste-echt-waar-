function parseTextToEvent(text) {
  const tijd = text.match(/(\d{1,2}):(\d{2})(?:\s*(?:tot|\-|â€“)\s*(\d{1,2}):(\d{2}))?/);
  let startH = 0, startM = 0, endH = null, endM = null;
  if (tijd) {
    startH = parseInt(tijd[1]);
    startM = parseInt(tijd[2]);
    if (tijd[3]) endH = parseInt(tijd[3]);
    if (tijd[4]) endM = parseInt(tijd[4]);
  }

  let datum = null;
  const dateMatch = text.match(/(\d{1,2})[\/-](\d{1,2})(?:[\/-](\d{2,4}))?|\b(\d{1,2})\s+(januari|februari|maart|april|mei|juni|juli|augustus|september|oktober|november|december)\b/i);
  if (dateMatch) {
    datum = new Date();
    if (dateMatch[1] && dateMatch[2]) {
      const day = parseInt(dateMatch[1]);
      const month = parseInt(dateMatch[2]) - 1;
      const year = dateMatch[3] ? parseInt(dateMatch[3]) : new Date().getFullYear();
      datum = new Date(year, month, day);
    } else if (dateMatch[4] && dateMatch[5]) {
      const months = {januari:0,februari:1,maart:2,april:3,mei:4,juni:5,juli:6,augustus:7,september:8,oktober:9,november:10,december:11};
      const day = parseInt(dateMatch[4]);
      const month = months[dateMatch[5].toLowerCase()];
      datum = new Date(new Date().getFullYear(), month, day);
    }
  }

  const title = text.split(/\d{1,2}[:\/]/)[0].trim() || "Gebeurtenis";
  const heleDag = document.getElementById("heleDag").checked;

  // Controle: datum of tijd moet herkend zijn
  if (!datum && !tijd) {
    return null;
  }
  if (!datum) {
    datum = new Date(); // fallback op vandaag
  }

  if (heleDag) {
    const startDate = datum.toISOString().split("T")[0];
    const endDate = new Date(datum.getTime() + 24 * 60 * 60 * 1000).toISOString().split("T")[0];
    return {
      summary: title,
      start: { date: startDate },
      end: { date: endDate }
    };
  } else {
    datum.setHours(startH, startM, 0, 0);
    const startDate = new Date(datum);
    const endDate = endH !== null ? new Date(datum.getFullYear(), datum.getMonth(), datum.getDate(), endH, endM || 0) : new Date(startDate.getTime() + 30 * 60 * 1000);
    return {
      summary: title,
      start: { dateTime: startDate.toISOString(), timeZone: 'Europe/Amsterdam' },
      end: { dateTime: endDate.toISOString(), timeZone: 'Europe/Amsterdam' }
    };
  }
}
